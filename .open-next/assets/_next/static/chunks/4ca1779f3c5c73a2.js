(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88814,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(20755),s=e.i(18566),l=e.i(22016),n=e.i(11152);function i(){let e=(0,s.useRouter)(),i=(0,s.useParams)().id,[d,o]=(0,t.useState)(!0),[c,g]=(0,t.useState)(!1),[u,x]=(0,t.useState)([]),[m,h]=(0,t.useState)(""),[p,y]=(0,t.useState)({customer_name:"",service_name:"",achievement:"",comment:"",rating:"5",status:"已发布",sort_order:"0"});(0,t.useEffect)(()=>{b()},[i]);let b=async()=>{try{let e=(0,a.createClient)(),{data:r,error:t}=await e.from("cases").select("*").eq("id",i).single();if(t)throw t;y({customer_name:r.customer_name,service_name:r.service_name,achievement:r.achievement,comment:r.comment,rating:r.rating.toString(),status:r.status,sort_order:r.sort_order.toString()}),x(r.highlights||[])}catch(r){alert("加载失败："+(r instanceof Error?r.message:"未知错误")),e.push("/admin/cases")}finally{o(!1)}},f=()=>{m.trim()&&(x([...u,m.trim()]),h(""))},v=async r=>{r.preventDefault(),g(!0);try{let r=(0,a.createClient)(),{error:t}=await r.from("cases").update({customer_name:p.customer_name,service_name:p.service_name,achievement:p.achievement,comment:p.comment,rating:parseInt(p.rating),highlights:u,status:p.status,sort_order:parseInt(p.sort_order)}).eq("id",i);if(t)throw t;alert("更新成功！"),e.push("/admin/cases")}catch(e){alert("更新失败："+(e instanceof Error?e.message:"未知错误"))}finally{g(!1)}};return d?(0,r.jsxs)("div",{className:"flex justify-center items-center py-20",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500"}),(0,r.jsx)("span",{className:"ml-4 text-gray-400",children:"加载中..."})]}):(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:"编辑案例"}),(0,r.jsx)(l.default,{href:"/admin/cases",className:"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"返回列表"})]}),(0,r.jsxs)("form",{onSubmit:v,className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["客户名称 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:p.customer_name,onChange:e=>y({...p,customer_name:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["服务名称 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",value:p.service_name,onChange:e=>y({...p,service_name:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["成果描述 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("textarea",{value:p.achievement,onChange:e=>y({...p,achievement:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["客户评价 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("textarea",{value:p.comment,onChange:e=>y({...p,comment:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:4,required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["评分 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{value:p.rating,onChange:e=>y({...p,rating:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,children:[(0,r.jsx)("option",{value:"5",children:"⭐⭐⭐⭐⭐ (5分)"}),(0,r.jsx)("option",{value:"4",children:"⭐⭐⭐⭐ (4分)"}),(0,r.jsx)("option",{value:"3",children:"⭐⭐⭐ (3分)"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"亮点标签"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:m,onChange:e=>h(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),f()),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"输入亮点后按回车或点击添加"}),(0,r.jsx)("button",{type:"button",onClick:f,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:(0,r.jsx)(n.FaPlus,{})})]}),u.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:u.map((e,t)=>(0,r.jsxs)("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded-full",children:[e,(0,r.jsx)("button",{type:"button",onClick:()=>{x(u.filter((e,r)=>r!==t))},className:"hover:text-red-500",children:(0,r.jsx)(n.FaTimes,{})})]},t))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"状态"}),(0,r.jsxs)("select",{value:p.status,onChange:e=>y({...p,status:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,r.jsx)("option",{value:"已发布",children:"已发布"}),(0,r.jsx)("option",{value:"草稿",children:"草稿"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"排序顺序"}),(0,r.jsx)("input",{type:"number",value:p.sort_order,onChange:e=>y({...p,sort_order:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"数字越小越靠前"})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("button",{type:"submit",disabled:c,className:"flex-1 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:c?"保存中...":"保存"}),(0,r.jsx)(l.default,{href:"/admin/cases",className:"px-6 py-3 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition text-center",children:"取消"})]})]})]})}e.s(["default",()=>i,"runtime",0,"edge"])}]);