-- 创建服务项目表
CREATE TABLE IF NOT EXISTS services (
  id BIGSERIAL PRIMARY KEY,
  category VARCHAR(50) NOT NULL,
  name VARCHAR(200) NOT NULL,
  price INTEGER NOT NULL,
  description TEXT,
  status VARCHAR(20) DEFAULT '已上架',
  sort_order INTEGER DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 创建索引
CREATE INDEX IF NOT EXISTS idx_services_category ON services(category);
CREATE INDEX IF NOT EXISTS idx_services_status ON services(status);
CREATE INDEX IF NOT EXISTS idx_services_sort_order ON services(sort_order);

-- 插入所有服务数据
INSERT INTO services (category, name, price, description, status, sort_order) VALUES
-- 赌约单
('赌约单', '赌约体验单', 288, '单局带出1000w', '已上架', 1),
('赌约单', '赌油单【标准版】', 209, '最高保底988w内出火箭燃料结单【出火箭燃料也要打满488w保底】', '已上架', 2),
('赌约单', '赌油单【困难版】', 588, '最高保底3588w内出火箭燃料结单【出火箭燃料也要打满1588w保底】', '已上架', 3),
('赌约单', '赌油单【不出不结版】', 988, '不出火箭燃料不结单【出火箭燃料也要打满4288w保底】', '已上架', 4),
('赌约单', '赌浮力设备单【保底版】', 488, '基础保底1488w 不出保底2288w', '已上架', 5),
('赌约单', '赌浮力设备单【不出不结版】', 1288, '3小时内出浮力设备 原班打手送免费一小时陪玩', '已上架', 6),

-- 护航保底
('护航保底', '体验单-绝密护航保底700W', 118, '限时每日体验1单', '已上架', 10),
('护航保底', '非洲之心-保底版', 288, '基础保底1314w 不出非洲之心加500w保底', '已上架', 11),
('护航保底', '绝密护航1288W', 248, '', '已上架', 12),
('护航保底', '绝密护航1788W', 358, '', '已上架', 13),
('护航保底', '绝密护航2888W', 568, '', '已上架', 14),
('护航保底', '绝密护航3388W', 668, '', '已上架', 15),

-- 趣味单
('趣味单', '特调单228微醉', 228, '基础保底1188w 累计带出龙舌兰x1 柠檬茶x3 可乐x3', '已上架', 20),
('趣味单', '特调单488畅饮', 488, '基础保底1888w 累计带出香槟x1 龙舌兰x1 柠檬茶x3 可乐x3', '已上架', 21),
('趣味单', '特调单888宿醉', 888, '基础保底2888w 累计带出香槟x4 龙舌兰x4 柠檬茶x8 可乐x8 特色酒杯x8', '已上架', 22),
('趣味单', '提神醒脑单 标准版', 288, '基础保底1488w  累计带出咖啡x1 挂耳咖啡x1 咖啡机x1 摩卡咖啡x1', '已上架', 23),
('趣味单', '提神醒脑单 高级版', 388, '基础保底1888w  累计带出高级咖啡豆x1 挂耳咖啡x1 咖啡机x1 摩卡咖啡x2', '已上架', 24),
('趣味单', '神龙套', 1688, '累计保底4888w  累计带出鱼子酱x3 香槟x8 龙舌兰x8 柠檬茶x8 特色酒杯x8 可乐x8 音响x4', '已上架', 25),
('趣味单', '对对磰1.0', 388, '保底880W（任意相同红加300W保底，在此基础上这个红每多出一个加150W-红包括：大红小红，不包括头甲，背包，子弹）', '已上架', 26),
('趣味单', '对对磰2.0', 588, '保底1280W（任意相同红加300W保底，在此基础上这个红每多出一个加150W-红包括：大红小红，不包括头甲，背包，子弹', '已上架', 27),
('趣味单', '军事专家', 388, '保底1388W（老板改装枪械给打手使用，击杀一人减少对应保底 - 30万该枪减少100万/50万改枪减少50万/70万改枪减少30万）', '已上架', 28),
('趣味单', '捏捏乐', 388, '保底888W（打手说话最后一个字带捏，被老板抓到一次没喊+50W）', '已上架', 29),
('趣味单', 'i人拯救者', 488, '保底1188W（陪玩使用技能需要讲出技能名称，每次释放都必须喊出技能（少喊一次加30万保底）', '已上架', 30),
('趣味单', '装机大师', 888, '保底1888W（收集物资：显卡，固态硬盘，CPU，电脑声卡，显示器，电源，风冷散热器，键盘，鼠标，主板，内存条，或出笔记本电脑直接接单 - 物资手机齐全，截图即可无需带出，一把未收集齐加80W保底）', '已上架', 31),
('趣味单', '紫气东来', 588, '保底777W（带出一个小紫增加15W保底（只计算撤离成功第一局，老板自己选择物资），带出物资截图发放客服进行保底计算，撤离失败加50万保底）', '已上架', 32),
('趣味单', '开锁大师', 988, '保底3188W（老板亲手摸够20个保险，这20个保险内出的所有物品不算保底）', '已上架', 33),
('趣味单', '宝宝真棒', 338, '保底728W（打手需全程称呼老板为"宝宝"，老板击杀AI或者干员，两个打手需要老板："宝宝真棒"，少叫一声加80W保底）', '已上架', 34),
('趣味单', '猎护者', 368, '保底1288W（必须击杀一队护航，否则不结单 - 护子队认定标准：打手至少5甲4头+满改枪/AWM+老板卡战备/大红包）', '已上架', 35),
('趣味单', '猎护者加强版', 888, '保底2688W（必须击杀三队护航，否则不结单 - 护子队认定标准：打手至少5甲4头+满改枪/AWM+老板卡战备/大红包）', '已上架', 36),
('趣味单', '房卡管家', 588, '保底1388W（打手必须开全部房卡，老板每摸到一个小红加100W保底，摸到一个大红加500W保底，叠加部分上限1800W）', '已上架', 37),
('趣味单', '满满当当', 868, '保底1888W（用金色/红色物资装满40格/45格大红包撤离，不装满不结单 - 枪/装备/子弹要件不算，金蛋一组60发算一格，非洲之心/海洋之泪算16格/红头修/红甲修满耐久才算）', '已上架', 38),
('趣味单', '刀皮收藏室-简单模式', 488, '累计打出5种刀皮，撤离失败不算', '已上架', 39),
('趣味单', '刀皮收藏室-进阶模式', 788, '累计打出7种刀皮，>100W红算赖子，撤离失败不算', '已上架', 40),
('趣味单', '刀皮收藏室-困难模式', 1888, '累计打出所有刀皮同时撤离成功，>200W红算赖子，撤离失败不算', '已上架', 41),
('趣味单', '天命之子-一阶段', 228, '基础保底1100W+一个限定小红', '已上架', 42),
('趣味单', '天命之子-二阶段', 488, '基础保底2000W+一个限定4格红', '已上架', 43),
('趣味单', '天命之子-三阶段', 888, '基础保底3200W+一个限定9格红', '已上架', 44),
('趣味单', '敏感大王', 488, '保底1488W，老板指定3个违禁词（1个字），打手违反规定加50W/一次，不设上限', '已上架', 45),
('趣味单', 'BINGO单-二连', 288, '二连：288R基础保底：1188W', '已上架', 46),
('趣味单', 'BINGO单-三连', 588, '三连：588R基础保底：2388W', '已上架', 47),
('趣味单', 'BINGO单-四连', 888, '四连：888R基础保底：3288W', '已上架', 48),
('趣味单', 'BINGO单-五连', 1688, '五连：1688R基础保底：4888W', '已上架', 49),
('趣味单', 'BINGO单-六连', 2688, '六连：2688R基础保底：6888W', '已上架', 50),
('趣味单', 'BINGO单-九宫格', 4888, '九宫格：4888R基础保底：8888W', '已上架', 51),

-- 摸红单
('摸红单', '不出一直打', 688, '保底1688W+累计2个相同的红，不可指定', '已上架', 60),
('摸红单', '不出一直打-高级版', 1488, '保底4888W+累计3个相同的红，不可指定', '已上架', 61),
('摸红单', '复苏呼吸机-不出不结', 9999, '保底1.2亿+复苏呼吸机', '已上架', 62),
('摸红单', '真非洲之心-不出不结', 13140, '保底1.38亿+非洲之心', '已上架', 63),
('摸红单', '能源大红-不出不结', 3888, '保底4588W+能源大红', '已上架', 64),
('摸红单', '卫星锅-不出不结', 388, '保底888W+卫星锅', '已上架', 65),
('摸红单', '火箭燃料-不出不结', 688, '保底1588W+火箭燃料', '已上架', 66),
('摸红单', '纵横/万金泪冠-不出不结', 6888, '保底1.3亿+纵横/万金泪冠（2出1即可）', '已上架', 67),
('摸红单', '浮力设备-不出不结', 988, '保底2888W+浮力设备', '已上架', 68),
('摸红单', '海洋之泪-不出不结', 23888, '保底4.8亿+海洋之泪', '已上架', 69),

-- 部门任务
('部门任务', '单个部门任务1-4级', 120, '完成单个部门任务1-4级', '已上架', 70),
('部门任务', '5个部门任务1-4级', 550, '完成5个部门任务1-4级', '已上架', 71),

-- 赛季3x3
('赛季3x3', '赛季3x3-不包损耗', 1088, '赛季9格保险箱，损耗控制在2500W以内，超了补', '已上架', 80),
('赛季3x3', '赛季3x3-包损耗', 1288, '赛季9格保险箱，3天内完成', '已上架', 81),

-- 陪玩
('陪玩', '娱乐陪单陪', 60, '1H（最低4套）', '已上架', 90),
('陪玩', '娱乐陪双培', 110, '1H（最低4套）', '已上架', 91),
('陪玩', 'A+单陪', 88, '1H（最低5杀）', '已上架', 92),
('陪玩', 'A+双陪', 168, '1H（10杀/H+保底800W，打够为止）', '已上架', 93),
('陪玩', 'S单陪', 128, '1H（8杀/H）', '已上架', 94),
('陪玩', 'S双陪', 288, '1H（12杀/H+保底1000W，打够为止）', '已上架', 95),
('陪玩', 'S+单陪', 168, '1H（12杀/H）', '已上架', 96),
('陪玩', 'S+双陪', 328, '1H（15杀/H+保底1300W，打够为止）', '已上架', 97),
('陪玩', '店长单陪', 588, '1H', '已上架', 98),
('陪玩', '店长+S+', 788, '1H', '已上架', 99),

-- 保险单
('保险单', '5次沙色保险', 488, '保底1788w 板板摸外5次沙色保险', '已上架', 100),
('保险单', '10次沙色保险', 788, '保底2588w 板板摸外10次沙色保险', '已上架', 101);

-- 启用行级安全 (RLS)
ALTER TABLE services ENABLE ROW LEVEL SECURITY;

-- 创建允许所有人读取的策略
CREATE POLICY "Allow public read access" ON services
  FOR SELECT
  USING (true);

-- 创建只允许认证用户写入的策略（管理后台使用）
CREATE POLICY "Allow authenticated users to insert" ON services
  FOR INSERT
  WITH CHECK (auth.role() = 'authenticated');

CREATE POLICY "Allow authenticated users to update" ON services
  FOR UPDATE
  USING (auth.role() = 'authenticated');

CREATE POLICY "Allow authenticated users to delete" ON services
  FOR DELETE
  USING (auth.role() = 'authenticated');
